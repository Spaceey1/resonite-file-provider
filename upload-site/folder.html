<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resonite Asset Manager - Folder</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Dashboard Section -->
        <section id="dashboard-section">
            <header class="main-header">
                <div class="container">
                    <div class="logo">Resonite<span>Assets</span></div>
                    <div class="user-info">
                        <span id="username-display">{{.Username}}</span>
                        <a href="/logout" class="btn btn-small">Logout</a>
                    </div>
                </div>
            </header>
            
            <div class="container main-content">
                <aside class="sidebar">
                    <div class="sidebar-header">
                        <h3>Folders</h3>
                        <button id="new-folder-btn" class="btn btn-small"><i class="fas fa-folder-plus"></i></button>
                    </div>
                    <div id="folder-tree" class="folder-tree">
                        {{range .Folders}}
                            <div class="folder" data-id="{{.ID}}">
                                <i class="fas fa-folder"></i> {{.Name}}
                            </div>
                        {{else}}
                            <p class="empty-folder">No folders</p>
                        {{end}}
                    </div>
                </aside>
                
                <main class="content">
                    <div class="toolbar">
                        <div class="breadcrumbs" id="breadcrumbs">
                            {{range $index, $crumb := .Path}}
                                {{if $index}}
                                    <span class="breadcrumb-separator">/</span>
                                {{end}}
                                <a href="/folder?id={{.ID}}&auth={{$.AuthToken}}" class="breadcrumb-item">{{.Name}}</a>
                            {{end}}
                        </div>
                        <div class="actions">
                            <button id="upload-btn" class="btn btn-primary"><i class="fas fa-upload"></i> Upload</button>
                        </div>
                    </div>
                    
                    <div id="items-container" class="items-container">
                        {{range .Items}}
                            <div class="item">
                                <i class="fas fa-file-alt"></i>
                                <div class="item-name">{{.Name}}</div>
                                <a href="{{.URL}}?auth={{$.AuthToken}}" class="item-link" target="_blank">View</a>
                            </div>
                        {{else}}
                            <div class="no-items-message">No items in this folder</div>
                        {{end}}
                    </div>
                </main>
            </div>
        </section>

        <!-- Modals -->
        <div id="upload-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Upload Asset</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="upload-form" action="/upload" method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="auth" value="{{.AuthToken}}">
                        <input type="hidden" name="folderId" value="{{.FolderId}}">
                        <div class="input-group">
                            <label for="file-upload">Select Resonite Package (.resonitepackage)</label>
                            <input type="file" id="file-upload" name="file" accept=".resonitepackage" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Upload</button>
                    </form>
                </div>
            </div>
        </div>

        <div id="new-folder-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create New Folder</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="new-folder-form" action="/addFolder" method="GET">
                        <input type="hidden" name="auth" value="{{.AuthToken}}">
                        <input type="hidden" name="folderId" value="{{.FolderId}}">
                        <div class="input-group">
                            <label for="folder-name">Folder Name</label>
                            <input type="text" id="folder-name" name="folderName" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Create</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const uploadBtn = document.getElementById('upload-btn');
            const uploadModal = document.getElementById('upload-modal');
            const newFolderBtn = document.getElementById('new-folder-btn');
            const newFolderModal = document.getElementById('new-folder-modal');
            const closeButtons = document.querySelectorAll('.close');
            
            // Toggle modals
            uploadBtn.addEventListener('click', () => {
                uploadModal.classList.add('active');
            });
            
            newFolderBtn.addEventListener('click', () => {
                newFolderModal.classList.add('active');
            });
            
            closeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const modal = btn.closest('.modal');
                    modal.classList.remove('active');
                });
            });
        });
    </script>
</body>
</html>